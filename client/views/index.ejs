<%- include('partials/header') %>
<a-scene physics="driver: ammo; debug: true; gravity: -9.8;" background="color: #FAFAFA">
    <!-- CAMERA, CONTROLLERS AND ENVIRONMENT SETTINGS -->
    <%- include('partials/basic_settings') %>

    <!-- BASE PLATE FOR CLOSER UI DESIGN -->
    <%- include('partials/base_plate') %>

    <a-mixin id="sphere-actions"
                hoverable draggable
                grabbable = "constraintComponentName: ammo-constraint;"
                event-set__hoveron="_event: hover-start; opacity: 0.7; transparent: true"
                event-set__hoveroff="_event: hover-end; opacity: 1; transparent: false"
    ></a-mixin>

    <a-mixin id="static-obj"
                geometry="primitive: box; depth: 0.75; height: 0.05; width: 1.25"
                material="color: gray"
                ammo-body="type: static" 
                ammo-shape="type: box"
    ></a-mixin>

    <a-mixin id="info-booth"
                transform-if-collided
                geometry="primitive: cylinder; height: 0.03; radius: 0.2"
                material="color: #24a0ed"
                ammo-body="type: static; emitCollisionEvents: true" 
                ammo-shape="type: box"
    ></a-mixin>

    <a-mixin id="add-booth"
                geometry="primitive: cylinder; height: 0.03; radius: 0.15"
                material="color: green"
                ammo-body="type: static; emitCollisionEvents: true" 
                ammo-shape="type: box"
    ></a-mixin>

    <a-mixin id="cancel-booth"
                geometry="primitive: cylinder; height: 0.03; radius: 0.15"
                material="color: red"
                ammo-body="type: static; emitCollisionEvents: true" 
                ammo-shape="type: box"
    ></a-mixin>

    <!-- current node view -->
    <a-sphere object-data="{}"
            ammo-body = "type: dynamic" 
            ammo-shape=" type: box" 
            mixin="sphere-actions" 
            id= "current_node" 
            visible= "false" 
            color="yellow" 
            radius="0.1" 
            position="0 1 -0.88">
        <a-text
            id ="current_node_label"
            position="0 0.3 0"
            width="1"
            color="white"
            value="NO NODE SELECTED"
            side="double"
            align="center"
        ></a-text>        
    </a-sphere>
    
    <!-- node search view -->
    <a-keyboard class="search-view" position="-0.75 0.85 -0.75" rotation="-35 0 0" scale="1 1 1" visible='true'></a-keyboard>
    <a-input id='input-1' class="search-view" position="-0.45 1.35 -1" placeholder="Search for node" color="black" width="0.6" visible="true"
    onclick="this.focus()">
        <a-button id="go-button" class="search-view" position="0.6 0 0" value="go" width='0.3' scale="0.5 0.5 0.5" search-clicked></a-button>
    </a-input>
    
    <a-entity id="main-table" position="0 0.75 -0.9" mixin = "static-obj"></a-entity>

    <a-entity id="center_booth" position="0 0.78 -0.9" mixin="info-booth"></a-entity>
    <a-entity id="left_booth" position="-0.5 0.78 -0.9" mixin="add-booth"></a-entity>
    <a-entity id="right_booth" position="0 0.78 -0.9" mixin="cancel-booth"></a-entity>


    <!--var add_booth=document.createElement('a-entity');
                                add_booth.setAttribute('geometry',"primitive: cylinder; height: 0.03; radius: 0.2");
                                add_booth.setAttribute("material","color:green");
                                add_booth.setAttribute("ammo-body","type: static; emitCollisionEvents: true" );
                                add_booth.setAttribute("ammo-shape","type: box");
                                add_booth.addEventListener('collidestart', function(evt){
                                    var target2=evt.detail.targetEl;

                                    if (target2.getAttribute('id') === "current_node"){
                                        var n=document.querySelector("#current_node");
                                        n.parentNode.removeChild(n);
                                    }
                                });
                                add_booth.setAttribute('position', "-0.5 0.78 -0.9");
                                add_booth.setAttribute('class', "action-button");

                        var sceneEl = document.querySelector('a-scene');

                        sceneEl.appendChild(add_booth);-->

    
    
</a-scene>
<script type="text/javascript">

    window.onload = function(event) {
        var input1= document.querySelector('#input-1');
        var str="";
        var keyboard = document.querySelector("a-keyboard");
        /*var toast = document.querySelector('a-toast');

        toast.addEventListener('actionclick', ()=>{
            toast.hide();

        });*/

        keyboard.addEventListener('input', (e)=>{
            str += e.detail;
            input1.setAttribute('value', str);
        });

        keyboard.addEventListener('backspace', (e)=>{
            str = str.slice(0, -1);
            input1.setAttribute('value', str);
        });

    };
    



</script>

<%- include('partials/footer') %>